Description: fix CMS verify infinite loop with unknown hash function
Author: Dr. Stephen Henson

Index: openssl-1.0.1f/crypto/cms/cms_smime.c
===================================================================
--- openssl-1.0.1f.orig/crypto/cms/cms_smime.c	2014-01-06 08:47:42.000000000 -0500
+++ openssl-1.0.1f/crypto/cms/cms_smime.c	2015-06-08 09:10:17.526774741 -0400
@@ -141,7 +141,7 @@
 			BIO_free(f);
 			f = tbio;
 			}
-		while (f != upto);
+		while (f && f != upto);
 		}
 	else
 		BIO_free_all(f);
