Backport of:

From e4840c88c516d959785fcd842d8658d3b7a6ae43 Mon Sep 17 00:00:00 2001
From: Alessandro Ghedini <alessandro@ghedini.me>
Date: Fri, 2 Oct 2015 14:38:30 +0200
Subject: [PATCH] Validate ClientHello extension field length
MIME-Version: 1.0
Content-Type: text/plain; charset=utf8
Content-Transfer-Encoding: 8bit

RT#4069

Reviewed-by: Emilia KÃ¤sper <emilia@openssl.org>
Reviewed-by: Matt Caswell <matt@openssl.org>
---
 ssl/t1_lib.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: openssl-1.0.1f/ssl/t1_lib.c
===================================================================
--- openssl-1.0.1f.orig/ssl/t1_lib.c	2017-01-30 11:17:32.467273420 -0500
+++ openssl-1.0.1f/ssl/t1_lib.c	2017-01-30 11:18:05.119716960 -0500
@@ -970,7 +970,7 @@
 		goto ri_check;
 	n2s(data,len);
 
-	if (data > (d+n-len)) 
+	if (data + len != d + n)
 		goto ri_check;
 
 	while (data <= (d+n-4))
